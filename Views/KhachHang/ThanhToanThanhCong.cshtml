@model CinemaManagement.Models.HoaDon
@{
    ViewData["Title"] = "Thanh toán thành công";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card border-success">
                <div class="card-header bg-success text-white text-center">
                    <h4 class="mb-0">
                        <i class="fas fa-check-circle me-2"></i>Thanh toán thành công!
                    </h4>
                </div>
                <div class="card-body">
                    <div class="text-center mb-4">
                        <i class="fas fa-check-circle text-success" style="font-size: 4rem;"></i>
                        <h5 class="mt-3 text-success">Cảm ơn bạn đã đặt vé!</h5>
                        <p class="text-muted">Vé của bạn đã được đặt thành công. Dưới đây là thông tin chi tiết.</p>
                    </div>

                    <!-- Thông tin hóa đơn -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6><i class="fas fa-receipt me-2"></i>Thông tin hóa đơn</h6>
                            <table class="table table-borderless table-sm">
                                <tr>
                                    <td><strong>Mã hóa đơn:</strong></td>
                                    <td>@Model.MaHoaDon</td>
                                </tr>
                                <tr>
                                    <td><strong>Thời gian:</strong></td>
                                    <td>@Model.ThoiGianTao.ToString("dd/MM/yyyy HH:mm")</td>
                                </tr>
                                <tr>
                                    <td><strong>Số lượng vé:</strong></td>
                                    <td>@Model.SoLuong vé</td>
                                </tr>
                                <tr>
                                    <td><strong>Tổng tiền:</strong></td>
                                    <td class="text-success fw-bold">@Model.TongTien.ToString("N0") VNĐ</td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-qrcode me-2"></i>Mã QR</h6>
                            <div class="text-center">
                                <div class="border rounded p-3" style="display: inline-block;">
                                    <i class="fas fa-qrcode" style="font-size: 80px; color: #666;"></i>
                                    <br>
                                    <small class="text-muted">@Model.MaHoaDon</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chi tiết vé -->
                    <h6><i class="fas fa-ticket-alt me-2"></i>Chi tiết vé</h6>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Mã vé</th>
                                    <th>Phim</th>
                                    <th>Phòng</th>
                                    <th>Ghế</th>
                                    <th>Thời gian chiếu</th>
                                    <th>Giá</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var cthd in Model.CTHDs)
                                {
                                    var ve = cthd.Ve;
                                    <tr>
                                        <td><code>@ve.MaVe</code></td>
                                        <td><strong>@ve.TenPhim</strong></td>
                                        <td>@ve.TenPhong</td>
                                        <td><span class="badge bg-primary">@ve.SoGhe</span></td>
                                        <td>@ve.LichChieu.ThoiGianBatDau.ToString("dd/MM/yyyy HH:mm")</td>
                                        <td class="text-success fw-bold">@ve.Gia.ToString("N0") VNĐ</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>

                    <!-- Hướng dẫn -->
                    <div class="alert alert-info">
                        <h6><i class="fas fa-info-circle me-2"></i>Hướng dẫn sử dụng vé</h6>
                        <ul class="mb-0">
                            <li>Vui lòng đến rạp trước giờ chiếu 15-30 phút</li>
                            <li>Xuất trình mã QR hoặc mã vé để kiểm tra</li>
                            <li>Vé có hiệu lực đến: <strong>@Model.CTHDs.First().Ve.HanSuDung.ToString("dd/MM/yyyy HH:mm")</strong></li>
                            <li>Liên hệ hotline nếu có vấn đề: <strong>1900-xxxx</strong></li>
                        </ul>
                    </div>

                    <!-- Các nút hành động -->
                    <div class="text-center">
                        <a href="@Url.Action("LichSuDatVe")" class="btn btn-primary me-2">
                            <i class="fas fa-history me-1"></i>Xem lịch sử đặt vé
                        </a>
                        <a href="@Url.Action("Index")" class="btn btn-outline-primary me-2">
                            <i class="fas fa-film me-1"></i>Đặt vé khác
                        </a>
                        <button type="button" class="btn btn-outline-secondary" onclick="window.print()">
                            <i class="fas fa-print me-1"></i>In vé
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Confetti effect
            if (typeof confetti !== 'undefined') {
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
            }
        });
    </script>
}
